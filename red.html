<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Диагностика Красной Струны</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #dc2626;
            background-image: linear-gradient(135deg, #dc2626 0%, #991b1b 30%, #7f1d1d 60%, #450a0a 100%);
            min-height: 100vh;
            color: #ffffff;
            overflow-x: hidden;
            position: relative;
            font-size: 22px;
            line-height: 1.7;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 10;
        }

        /* Glassmorphism Cards */
        .glass-card {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(25px);
            border-radius: 24px;
            border: 2px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 12px 40px rgba(31, 38, 135, 0.5);
            padding: 60px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
        }

        .header h1 {
            font-size: 5.5rem;
            font-weight: 800;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #ffffff, #fecaca, #dc2626);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
            text-transform: uppercase;
            text-shadow: 0 6px 12px rgba(0,0,0,0.5);
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.8));
            word-wrap: break-word;
            hyphens: auto;
        }

        .intro-text {
            font-size: 2rem;
            line-height: 1.8;
            color: #ffffff;
            text-align: center;
            font-weight: 600;
            text-shadow: 3px 3px 12px rgba(0,0,0,1);
            background: rgba(0,0,0,0.6);
            padding: 30px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        /* Bento Box Layout */
        .bento-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 28px;
            margin: 50px 0;
        }

        .bento-item {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.6);
            padding: 45px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
            text-shadow: 2px 2px 8px rgba(0,0,0,1);
            line-height: 1.6;
            text-align: center;
        }

        .bento-item:hover {
            transform: translateY(-8px);
            background: rgba(0, 0, 0, 0.8);
            box-shadow: 0 25px 50px rgba(31, 38, 135, 0.6);
            border-color: rgba(255, 255, 255, 0.8);
        }

        .bento-item.selected {
            background: rgba(220, 38, 38, 0.8);
            border-color: rgba(220, 38, 38, 1);
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 30px 60px rgba(220, 38, 38, 0.7);
        }

        /* Color Palette */
        .color-palette {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 35px;
            margin: 50px 0;
        }

        .color-option {
            height: 200px;
            border-radius: 24px;
            cursor: pointer;
            transition: all 0.4s ease;
            border: 3px solid rgba(255, 255, 255, 0.4);
            position: relative;
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .color-option:hover {
            transform: translateY(-12px) scale(1.05);
            box-shadow: 0 35px 70px rgba(0, 0, 0, 0.4);
        }

        .color-option.selected {
            border-color: rgba(255, 255, 255, 1);
            transform: translateY(-12px) scale(1.05);
            box-shadow: 0 0 60px rgba(255, 255, 255, 0.6);
        }

        .part4 { background: linear-gradient(135deg, #ff9a9e, #fecfef, #fecfef); }
        .part3 { background: linear-gradient(135deg, #ff6b6b, #ee5a52, #ff9a9e); }
        .part2 { background: linear-gradient(135deg, #e74c3c, #c0392b, #e74c3c); }
        .part1 { background: linear-gradient(135deg, #c0392b, #922b21, #8b0000); }
        .matrix { background: linear-gradient(135deg, #8d6e63, #5d4037, #3e2723); }

        /* Buttons */
        .neo-btn {
            background: linear-gradient(145deg, #dc2626, #991b1b);
            border: none;
            color: white;
            padding: 28px 56px;
            border-radius: 20px;
            font-size: 1.8rem;
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 50px auto;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.4);
            text-shadow: 2px 2px 6px rgba(0,0,0,0.5);
            box-shadow: 0 8px 32px rgba(220, 38, 38, 0.4);
        }

        .neo-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 45px rgba(220, 38, 38, 0.8);
            background: linear-gradient(145deg, #ef4444, #dc2626);
        }

        /* Progress Bar */
        .progress-container {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(15px);
            border-radius: 50px;
            padding: 8px;
            margin-bottom: 50px;
            border: 2px solid rgba(255, 255, 255, 0.4);
        }

        .progress-fill {
            height: 20px;
            background: linear-gradient(90deg, #dc2626, #ef4444, #f87171);
            border-radius: 50px;
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.6);
        }

        /* Question Styles */
        .question-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
            color: #ffffff;
            letter-spacing: -0.01em;
            text-shadow: 4px 4px 16px rgba(0,0,0,1);
            background: rgba(0,0,0,0.7);
            padding: 25px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .question-subtitle {
            font-size: 1.7rem;
            margin-bottom: 50px;
            text-align: center;
            color: #ffffff;
            font-weight: 600;
            text-shadow: 3px 3px 12px rgba(0,0,0,1);
            background: rgba(0,0,0,0.6);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .question-counter {
            text-align: center;
            font-size: 1.6rem;
            margin-bottom: 40px;
            font-weight: 700;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 3px 3px 12px rgba(0,0,0,1);
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        /* Results */
        .result-title {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 40px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: -0.02em;
            text-shadow: 4px 4px 16px rgba(0,0,0,1);
            background: rgba(0,0,0,0.7);
            padding: 30px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .result-description {
            font-size: 1.8rem;
            line-height: 1.9;
            margin: 40px 0;
            color: #ffffff;
            text-align: center;
            font-weight: 600;
            text-shadow: 3px 3px 12px rgba(0,0,0,1);
            background: rgba(0,0,0,0.6);
            padding: 30px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .recommendation-box {
            background: rgba(239, 68, 68, 0.3);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            border: 2px solid rgba(239, 68, 68, 0.6);
            font-size: 1.5rem;
            font-weight: 600;
            text-shadow: 2px 2px 6px rgba(0,0,0,0.5);
            color: #ffffff;
        }

        /* Test Container */
        .test-container {
            display: none;
        }

        .test-container.active {
            display: block;
        }

        .results {
            display: none;
        }

        .results.show {
            display: block;
        }

        /* State Colors */
        .tense { color: #ffa726; text-shadow: 0 0 25px #ffa726; }
        .slack { color: #42a5f5; text-shadow: 0 0 25px #42a5f5; }
        .broken { color: #ef5350; text-shadow: 0 0 25px #ef5350; }
        .normal { color: #66bb6a; text-shadow: 0 0 25px #66bb6a; }

        /* Mobile Optimization */
        @media (max-width: 768px) {
            body { font-size: 18px; }
            .container { padding: 20px 15px; }
            .header h1 { 
                font-size: 2.8rem; 
                line-height: 1.1;
                word-break: break-word;
                hyphens: auto;
            }
            .intro-text { 
                font-size: 1.4rem; 
                padding: 20px; 
                line-height: 1.5;
            }
            .question-title { 
                font-size: 2rem; 
                padding: 15px;
                line-height: 1.2;
                word-break: break-word;
            }
            .question-subtitle { 
                font-size: 1.2rem; 
                padding: 15px; 
                line-height: 1.4;
            }
            .question-counter { 
                font-size: 1.1rem; 
                padding: 10px; 
                letter-spacing: 1px;
            }
            .glass-card { padding: 25px; }
            .color-palette { grid-template-columns: repeat(2, 1fr); gap: 15px; }
            .color-option { height: 120px; }
            .bento-grid { grid-template-columns: 1fr; gap: 15px; }
            .bento-item { 
                padding: 20px; 
                font-size: 1.1rem;
                line-height: 1.4;
                font-weight: 700;
                background: rgba(0, 0, 0, 0.8);
                border: 2px solid rgba(255, 255, 255, 0.8);
            }
            .neo-btn { 
                padding: 18px 36px; 
                font-size: 1.3rem;
                margin: 30px auto;
            }
            .result-title { 
                font-size: 2.2rem; 
                padding: 20px;
                line-height: 1.2;
                word-break: break-word;
            }
            .result-description { 
                font-size: 1.3rem; 
                padding: 20px; 
                line-height: 1.5;
            }
            .recommendation-box { 
                padding: 25px; 
                font-size: 1.2rem;
                line-height: 1.5;
            }
        }

        @media (max-width: 480px) {
            body { font-size: 16px; }
            .header h1 { 
                font-size: 2.2rem;
                line-height: 1.1;
            }
            .intro-text { 
                font-size: 1.2rem; 
                padding: 15px;
                line-height: 1.4;
            }
            .question-title { 
                font-size: 1.6rem; 
                padding: 12px;
                line-height: 1.2;
            }
            .question-subtitle { 
                font-size: 1rem; 
                padding: 12px;
                line-height: 1.3;
            }
            .question-counter { 
                font-size: 0.9rem; 
                padding: 8px;
                letter-spacing: 0.5px;
            }
            .glass-card { padding: 20px; }
            .bento-item { 
                padding: 15px; 
                font-size: 1rem;
                line-height: 1.3;
                font-weight: 700;
                background: rgba(0, 0, 0, 0.85);
                border: 2px solid rgba(255, 255, 255, 0.9);
            }
            .neo-btn { 
                padding: 15px 30px; 
                font-size: 1.1rem;
                margin: 25px auto;
            }
            .result-title { 
                font-size: 1.8rem; 
                padding: 15px;
                line-height: 1.1;
            }
            .result-description { 
                font-size: 1.1rem; 
                padding: 15px;
                line-height: 1.4;
            }
            .recommendation-box { 
                padding: 20px; 
                font-size: 1rem;
                line-height: 1.4;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header" id="header">
            <div class="glass-card">
                <h1>Диагностика Красной Струны</h1>
                <div class="intro-text">
                    <p><strong>Определите текущее состояние своей красной струны здоровья через уникальную диагностику на основе науки о времени.</strong></p>
                </div>
                <button class="neo-btn" id="startBtn">Начать диагностику</button>
            </div>
        </div>

        <div class="test-container" id="testContainer">
            <div class="progress-container">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="question-counter" id="questionCounter"></div>
            <div id="questionContent"></div>
        </div>

        <div class="results" id="results">
            <div class="glass-card">
                <h2 class="result-title">Результат диагностики</h2>
                <div class="result-title" id="stringState"></div>
                <div class="result-description" id="stateDescription"></div>
                <div class="recommendation-box" id="bookRecommendation"></div>
                <button class="neo-btn" id="showAnswersBtn">Просмотреть ответы</button>
                <button class="neo-btn" id="restartBtn">Пройти еще раз</button>
            </div>
        </div>
    </div>

    <script>
        let currentQuestion = 0;
        let answers = {};

        const questions = [
            {
                id: 'color',
                title: 'Выберите цвет, который вас притягивает',
                subtitle: 'Цветовая диагностика красной струны',
                type: 'color',
                colors: [
                    { class: 'part4', value: 'part4' },
                    { class: 'part3', value: 'part3' },
                    { class: 'part2', value: 'part2' },
                    { class: 'part1', value: 'part1' },
                    { class: 'matrix', value: 'matrix' }
                ]
            },
            {
                id: 'movement',
                title: 'Как вы оцениваете свою физическую активность?',
                subtitle: 'Красная струна отвечает за движения',
                type: 'options',
                options: [
                    { text: 'Мои движения четкие, целенаправленные, но иногда чувствую ограничения', value: 'tense' },
                    { text: 'Двигаюсь много, но хаотично, без системы и порядка', value: 'slack' },
                    { text: 'Движений очень мало, часто чувствую слабость и усталость', value: 'broken' },
                    { text: 'Мои движения гармоничны, чувствую радость от активности', value: 'normal' }
                ]
            },
            {
                id: 'health',
                title: 'Как вы характеризуете свое здоровье?',
                subtitle: 'Красная струна - цвет здоровья',
                type: 'options',
                options: [
                    { text: 'Здоровье хорошее, но чувствую некоторую скованность', value: 'tense' },
                    { text: 'Энергии много, но она нестабильна, скачет', value: 'slack' },
                    { text: 'Часто болею, чувствую упадок сил', value: 'broken' },
                    { text: 'Доволен здоровьем, активно занимаюсь телом', value: 'normal' }
                ]
            },
            {
                id: 'names',
                title: 'Сколько людей с именами Елена и Дмитрий в вашем окружении?',
                subtitle: 'Имена Елена-Дмитрий звучат на красной струне',
                type: 'options',
                options: [
                    { text: 'Много Елен вокруг меня', value: 'tense' },
                    { text: 'Много Дмитриев в окружении', value: 'slack' },
                    { text: 'И Елены, и Дмитрии примерно поровну', value: 'normal' },
                    { text: 'Мало таких имен или не обращаю внимания', value: 'few' }
                ]
            },
            {
                id: 'redcolor',
                title: 'Какое у вас отношение к красному цвету?',
                subtitle: 'Красный - цвет здоровья и красной струны',
                type: 'options',
                options: [
                    { text: 'Нравится, но использую дозированно', value: 'tense' },
                    { text: 'Обожаю красный, часто его выбираю', value: 'slack' },
                    { text: 'Избегаю красного цвета', value: 'broken' },
                    { text: 'Нравится красный, использую гармонично', value: 'normal' }
                ]
            },
            {
                id: 'providing',
                title: 'Как вы обеспечиваете себя необходимым для жизни?',
                subtitle: 'Красная струна связана с обеспечением жизни',
                type: 'options',
                options: [
                    { text: 'Обеспечиваю стабильно, но с большими усилиями', value: 'tense' },
                    { text: 'То густо, то пусто - очень нестабильно', value: 'slack' },
                    { text: 'С трудом обеспечиваю базовые потребности', value: 'broken' },
                    { text: 'Легко обеспечиваю себя всем необходимым', value: 'normal' }
                ]
            },
            {
                id: 'month',
                title: 'В каком месяце вы родились?',
                subtitle: 'Ноябрь - месяц красной струны',
                type: 'options',
                options: [
                    { text: 'Ноябрь', value: 'november' },
                    { text: 'Весенние месяцы (март, апрель, май)', value: 'spring' },
                    { text: 'Летние месяцы (июнь, июль, август)', value: 'summer' },
                    { text: 'Другие осенне-зимние месяцы', value: 'other' }
                ]
            },
            {
                id: 'myname',
                title: 'Как вас зовут?',
                subtitle: 'Ваше собственное имя влияет на красную струну',
                type: 'options',
                options: [
                    { text: 'Меня зовут Елена', value: 'elena' },
                    { text: 'Меня зовут Дмитрий', value: 'dmitry' },
                    { text: 'Другое имя', value: 'other' },
                    { text: 'Предпочитаю не говорить', value: 'private' }
                ]
            },
            {
                id: 'weekday',
                title: 'В какой день недели вы родились?',
                subtitle: 'Воскресенье - день красной струны',
                type: 'options',
                options: [
                    { text: 'Воскресенье', value: 'sunday' },
                    { text: 'Понедельник', value: 'monday' },
                    { text: 'Вторник', value: 'tuesday' },
                    { text: 'Среда', value: 'wednesday' },
                    { text: 'Четверг', value: 'thursday' },
                    { text: 'Пятница', value: 'friday' },
                    { text: 'Суббота', value: 'saturday' },
                    { text: 'Не знаю', value: 'unknown' }
                ]
            }
        ];

        const stringStates = {
            tense: {
                name: 'НАТЯНУТАЯ СТРУНА',
                description: 'Ваша красная струна натянута. Проявляется тем, что у вас начинаются потери и резкое сокращение движений. Вы чувствуете скованность, ограничения, но при этом сохраняете стабильность.'
            },
            slack: {
                name: 'ПРОВИСШАЯ СТРУНА', 
                description: 'Ваша красная струна провисла. Эти струны слишком ослаблены. Если вы много и беспорядочно двигаетесь – провисла красная струна. Энергия есть, но она неуправляема.'
            },
            broken: {
                name: 'ПОРВАННАЯ СТРУНА',
                description: 'Ваша красная струна порвана. Это самая крайняя степень деформации. Если у человека рвётся красная струна, он начинает болеть. Вы теряете опору и выпадаете из знаковой системы этого мира.'
            },
            normal: {
                name: 'СТРУНА В ПОРЯДКЕ',
                description: 'Ваша красная струна в порядке! Вы чувствуете гармонию в движениях, здоровье в норме, энергия течет свободно. У вас есть баланс между активностью и покоем. Красный цвет дарит вам состояние радости и наполненности жизни.'
            }
        };

        function init() {
            document.getElementById('startBtn').addEventListener('click', startTest);
            document.getElementById('restartBtn').addEventListener('click', restartTest);
            document.getElementById('showAnswersBtn').addEventListener('click', showAnswers);
        }

        function startTest() {
            currentQuestion = 0;
            answers = {};
            
            document.getElementById('header').style.display = 'none';
            document.getElementById('results').classList.remove('show');
            document.getElementById('testContainer').classList.add('active');
            showQuestion();
        }

        function showQuestion() {
            const question = questions[currentQuestion];
            const questionContent = document.getElementById('questionContent');
            const progressFill = document.getElementById('progressFill');
            const questionCounter = document.getElementById('questionCounter');
            
            progressFill.style.width = ((currentQuestion + 1) / questions.length * 100) + '%';
            questionCounter.innerHTML = 'Вопрос ' + (currentQuestion + 1) + ' из ' + questions.length;
            
            let html = '<div class="glass-card">';
            html += '<div class="question-title">' + question.title + '</div>';
            html += '<div class="question-subtitle">' + question.subtitle + '</div>';
            
            if (question.type === 'color') {
                html += '<div class="color-palette">';
                question.colors.forEach(color => {
                    html += `<div class="color-option ${color.class}" onclick="selectAnswer('${color.value}')"></div>`;
                });
                html += '</div>';
            } else {
                html += '<div class="bento-grid">';
                question.options.forEach(option => {
                    html += `<div class="bento-item" onclick="selectAnswer('${option.value}')">${option.text}</div>`;
                });
                html += '</div>';
            }
            
            html += '<button class="neo-btn" id="nextBtn" style="display: none;" onclick="nextQuestion()">Следующий вопрос</button>';
            html += '</div>';
            
            questionContent.innerHTML = html;
        }

        function selectAnswer(value) {
            answers[questions[currentQuestion].id] = value;
            
            // Убираем выделение со всех элементов
            const allItems = document.querySelectorAll('.bento-item, .color-option');
            allItems.forEach(item => item.classList.remove('selected'));
            
            // Выделяем выбранный элемент
            const selectedElement = event.target;
            selectedElement.classList.add('selected');
            
            document.getElementById('nextBtn').style.display = 'block';
        }

        function nextQuestion() {
            currentQuestion++;
            
            if (currentQuestion < questions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        function analyzeStringState() {
            // Подсчет совпадений с красной струной (ведущая)
            let redStringMatches = 0;
            const totalRedChecks = 4;
            
            if (answers.month === 'november') redStringMatches++;
            if (answers.weekday === 'sunday') redStringMatches++;
            if (answers.health === 'normal') redStringMatches++;
            if (answers.myname === 'elena' || answers.myname === 'dmitry') redStringMatches++;
            
            // Подсчет ответов по состояниям струны
            let tenseCount = 0;
            let slackCount = 0;
            let brokenCount = 0;
            let normalCount = 0;
            
            // Движение - главный критерий (считается за 2)
            if (answers.movement === 'tense') tenseCount += 2;
            if (answers.movement === 'slack') slackCount += 2;
            if (answers.movement === 'broken') brokenCount += 2;
            if (answers.movement === 'normal') normalCount += 2;
            
            // Здоровье - "болею" считается за 2
            if (answers.health === 'tense') tenseCount++;
            if (answers.health === 'slack') slackCount++;
            if (answers.health === 'broken') brokenCount += 2;
            if (answers.health === 'normal') normalCount++;
            
            // Имена в окружении
            if (answers.names === 'tense') tenseCount++;
            if (answers.names === 'slack') slackCount++;
            if (answers.names === 'normal' || answers.names === 'few') normalCount++;
            
            // Отношение к красному
            if (answers.redcolor === 'tense') tenseCount++;
            if (answers.redcolor === 'slack') slackCount++;
            if (answers.redcolor === 'broken') brokenCount++;
            if (answers.redcolor === 'normal') normalCount++;
            
            // Обеспечение жизни
            if (answers.providing === 'tense') tenseCount++;
            if (answers.providing === 'slack') slackCount++;
            if (answers.providing === 'broken') brokenCount++;
            if (answers.providing === 'normal') normalCount++;
            
            // Определяем состояние с максимальным количеством ответов
            const maxCount = Math.max(tenseCount, slackCount, brokenCount, normalCount);
            
            let state = 'normal';
            if (brokenCount === maxCount) state = 'broken';
            else if (slackCount === maxCount) state = 'slack';
            else if (tenseCount === maxCount) state = 'tense';
            else if (normalCount === maxCount) state = 'normal';
            
            return { state: state, redMatches: redStringMatches, totalChecks: totalRedChecks };
        }

        function showResults() {
            document.getElementById('testContainer').style.display = 'none';
            document.getElementById('results').classList.add('show');
            
            const analysis = analyzeStringState();
            const stateResult = analysis.state;
            const redMatches = analysis.redMatches;
            const totalChecks = analysis.totalChecks;
            
            const resultState = stringStates[stateResult];
            
            // Определяем книгу по выбранному цвету
            const colorChoice = answers.color;
            let bookTitle = '';
            
            switch(colorChoice) {
                case 'part4':
                    bookTitle = 'Откровенное Знакомство - Часть 4';
                    break;
                case 'part3':
                    bookTitle = 'Откровенное Знакомство - Часть 3';
                    break;
                case 'part2':
                    bookTitle = 'Откровенное Знакомство - Часть 2';
                    break;
                case 'part1':
                    bookTitle = 'Откровенное Знакомство - Часть 1';
                    break;
                case 'matrix':
                    bookTitle = 'Матрица Здоровья';
                    break;
                default:
                    bookTitle = 'Откровенное Знакомство';
            }
            
            // Проверка на ведущую струну
            let dominantInfo = '';
            if (redMatches >= 1) {
                dominantInfo = '<div style="background: rgba(220,38,38,0.3); backdrop-filter: blur(20px); padding: 30px; border-radius: 16px; border: 2px solid rgba(220,38,38,0.6); margin: 30px 0;">' +
                    '<h3 style="color: #ffffff; margin-bottom: 15px; text-transform: uppercase; font-size: 1.6rem; font-weight: 700; text-shadow: 2px 2px 6px rgba(0,0,0,0.7);">Красная струна ведущая</h3>' +
                    '<p style="font-size: 1.4rem; color: #ffffff; font-weight: 600; text-shadow: 2px 2px 6px rgba(0,0,0,0.5);">Найдено ' + redMatches + ' совпадений из ' + totalChecks + ' возможных</p>' +
                    '</div>';
            }
            
            document.getElementById('stringState').innerHTML = resultState.name;
            document.getElementById('stringState').className = 'result-title ' + stateResult;
            document.getElementById('stateDescription').innerHTML = resultState.description;
            document.getElementById('bookRecommendation').innerHTML = 
                '<h3 style="text-transform: uppercase; letter-spacing: 1px; margin-bottom: 20px; font-size: 1.8rem; color: #ffffff; font-weight: 700; text-shadow: 2px 2px 6px rgba(0,0,0,0.7);">Рекомендуемая книга</h3>' +
                '<h4 style="font-size: 2rem; margin: 20px 0; color: #ffffff; font-weight: 700; text-shadow: 2px 2px 8px rgba(0,0,0,0.8); background: rgba(239,68,68,0.4); padding: 20px; border-radius: 12px; border: 1px solid rgba(239,68,68,0.6);">' + bookTitle + '</h4>' +
                dominantInfo +
                '<div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(15px); padding: 30px; border-radius: 16px; border: 2px solid rgba(255,255,255,0.25); margin-top: 30px;">' +
                '<p style="font-size: 1.4rem; font-style: italic; color: #ffffff; font-weight: 600; text-shadow: 2px 2px 6px rgba(0,0,0,0.5);">Для более точного определения состояния струны рекомендую обратиться к Ритмологу</p>' +
                '</div>';
        }

        function showAnswers() {
            let answersHtml = '<div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(20px); padding: 40px; border-radius: 20px; margin: 40px 0; border: 2px solid rgba(255,255,255,0.25);">';
            answersHtml += '<h3 style="margin-bottom: 30px; text-transform: uppercase; font-size: 1.8rem; color: #ffffff; font-weight: 700; text-shadow: 2px 2px 6px rgba(0,0,0,0.7);">Ваши ответы</h3>';
            
            // Цвет
            const colorNames = {
                'part4': 'Светло-розовый (Часть 4)',
                'part3': 'Розово-красный (Часть 3)', 
                'part2': 'Красный (Часть 2)',
                'part1': 'Темно-красный (Часть 1)',
                'matrix': 'Коричневый (Матрица)'
            };
            answersHtml += '<p style="margin: 20px 0; font-size: 1.4rem; color: #ffffff; font-weight: 600; text-shadow: 2px 2px 6px rgba(0,0,0,0.5);"><strong>Выбранный цвет:</strong> ' + (colorNames[answers.color] || 'Не выбран') + '</p>';
            
            // Остальные ответы
            const questionTexts = {
                'movement': 'Физическая активность',
                'health': 'Здоровье', 
                'names': 'Имена в окружении',
                'redcolor': 'Отношение к красному',
                'providing': 'Обеспечение жизни',
                'month': 'Месяц рождения',
                'myname': 'Ваше имя',
                'weekday': 'День недели рождения'
            };
            
            for (const key in answers) {
                if (key !== 'color' && questionTexts[key]) {
                    const selectedOption = getSelectedOptionText(key, answers[key]);
                    answersHtml += '<p style="margin: 20px 0; font-size: 1.4rem; color: #ffffff; font-weight: 600; text-shadow: 2px 2px 6px rgba(0,0,0,0.5);"><strong>' + questionTexts[key] + ':</strong> ' + selectedOption + '</p>';
                }
            }
            
            answersHtml += '</div>';
            
            document.getElementById('bookRecommendation').innerHTML += answersHtml;
            document.getElementById('showAnswersBtn').style.display = 'none';
        }
        
        function getSelectedOptionText(questionId, value) {
            const question = questions.find(q => q.id === questionId);
            if (!question) return value;
            
            if (question.options) {
                const option = question.options.find(opt => opt.value === value);
                return option ? option.text : value;
            }
            
            return value;
        }

        function restartTest() {
            location.reload();
        }

        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
